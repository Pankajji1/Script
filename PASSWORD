<?php
// URLs array (random URLs add)
/*$urls = [
"https://pankajxscripts.blogspot.com/p/your-access-key-amyvdvucvv-copy-created.html",
"https://pankajxscripts.blogspot.com/p/2.html",
"https://pankajxscripts.blogspot.com/p/3.html",
"https://pankajxscripts.blogspot.com/p/4.html",
"https://pankajxscripts.blogspot.com/p/5.html",
"https://pankajxscripts.blogspot.com/p/your-access-key-pankajxscripts8851-body.html",
"https://pankajxscripts.blogspot.com/p/7.html",
"https://pankajxscripts.blogspot.com/p/8.html",
"https://pankajxscripts.blogspot.com/p/9_19.html",
"https://pankajxscripts.blogspot.com/p/10_19.html",
"https://pankajxscripts.blogspot.com/p/11_19.html",
"https://pankajxscripts.blogspot.com/p/12_19.html",
"https://pankajxscripts.blogspot.com/p/13_19.html",
"https://pankajxscripts.blogspot.com/p/14_19.html",
"https://pankajxscripts.blogspot.com/p/15_19.html",
"https://pankajxscripts.blogspot.com/p/16_19.html",
"https://pankajxscripts.blogspot.com/p/17_19.html",
"https://pankajxscripts.blogspot.com/p/18_19.html",
"https://pankajxscripts.blogspot.com/p/19_19.html",
"https://pankajxscripts.blogspot.com/p/20_19.html",
"https://pankajxscripts.blogspot.com/p/21_19.html",
"https://pankajxscripts.blogspot.com/p/22_19.html",
"https://pankajxscripts.blogspot.com/p/23_19.html",
"https://pankajxscripts.blogspot.com/p/24_19.html",
"https://pankajxscripts.blogspot.com/p/25_19.html",
"https://pankajxscripts.blogspot.com/p/26_19.html",
"https://pankajxscripts.blogspot.com/p/27_19.html",
"https://pankajxscripts.blogspot.com/p/28_19.html",
"https://pankajxscripts.blogspot.com/p/29_19.html",
"https://pankajxscripts.blogspot.com/p/30_19.html"
];


// Random URL select
$url = $urls[array_rand($urls)];

// cURL à¤¸à¥‡ à¤ªà¥‡à¤œ fetch à¤•à¤°à¤¨à¤¾
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_USERAGENT, "PHP Fetch Script");
 $res = curl_exec($ch);
curl_close($ch);
$Newkey=explode('">',explode('<input type="hidden" id="keyBox" value="',$res)[1])[0];
 */
function randomKey($length = 10) {
    $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    return substr(str_shuffle(str_repeat($chars, $length)), 0, $length);
}

$key = randomKey(12);

$data = http_build_query([
    'content' => $key,
    'title' => 'Random Key',
    'syntax' => 'text',
    'expiry_days' => 7
]);

$ch = curl_init('https://dpaste.com/api/');
curl_setopt_array($ch, [
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_POSTFIELDS => $data
]);

$res = curl_exec($ch);
curl_close($ch);

// Shortlink API
$ch = curl_init("https://vuotnhanh.com/api?api=d33cfe6d-d52d-43e8-bcf1-2ae572662a54&url=".urlencode($res));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, 0);
$data = curl_exec($ch);
curl_close($ch);

$shortenedUrl = json_decode($data,true)["shortenedUrl"];

// à¤Ÿà¤°à¥à¤®à¤¿à¤¨à¤² à¤¸à¤¾à¤«à¤¼ à¤•à¤°à¥‡à¤‚
@system(strtoupper(substr(PHP_OS, 0, 3)) === 'WIN' ? "cls" : "clear");

// ANSI à¤•à¤²à¤°
$blue = "\033[1;34m";   
$green = "\033[1;32m";  
$red = "\033[1;31m";    
$reset = "\033[0m";     

// ASCII à¤†à¤°à¥à¤Ÿ
echo $blue . "
  _____                                   
 |  __ \                                  
 | |__) |_ _ ___ _____   _____ _ __ __ _  
 |  ___/ _` / __/ __ \ \ / / _ \ '__/ _` | 
 | |  | (_| \__ \__ \ V /  __/ | | (_| |  
 |_|   \__,_|___/___/ \_/ \___|_|  \__,_|  
\n" . $reset;

// Link print
echo "ðŸ”— Link Password: " . $green . $shortenedUrl . "\n" . $reset;

// Password input
function getPassword() {
    echo "[+] Enter Key: ";
    return trim(fgets(STDIN));
}

// Password check
function checkPassword() {
    global $key;
    $attempt = getPassword();

    if (trim($attempt) === trim($key)) {
        echo "\033[1;32mâœ… Password correct!\n\033[0m";
        sleep(1);
        file_put_contents("key", password_hash($key, PASSWORD_BCRYPT));
        return true;
    }

    echo "\033[1;31mâŒ Wrong password!\n\033[0m";
    return false;
}

// Expiry time check
$expiryTime = 43200; // 12 hours
$file = "key";
if (file_exists($file) && (time() - filemtime($file) > $expiryTime)) {
    unlink($file); // Expired
}

// First password check
if (!checkPassword()) {
    if (file_exists($file)) unlink($file);
    while (!checkPassword()) {
        sleep(1);
    }
}

echo "âœ… Access Granted!\n";
